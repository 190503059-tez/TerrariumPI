{# Include the modal base html template #}
{% extends "layouts/modal.html" %}

{# Set some variables #}
{% set modal_size = 'modal-xl' %}
{% set modal_type = 'weather' %}
{% set modal_form_add_action  = url_for('api:setting_update', setting='weather_source') %}
{% set modal_form_edit_action = url_for('api:setting_update', setting='weather_source') %}
{% set modal_reload_url = url_for('page', page='weather') %}

{% block modal_title %}<i class="fas fa-cloud-sun mr-2" ></i>{{ _('Weather settings') }}{% endblock %}
{% block modal_body %}
<input type="hidden" name="id" id="setting_name" value="weather_source">
<p>{{ _('Enter the online source url for your weather information. Valid urls are shown below.') }}</p>
<p id="weather_setup_info"></p>
<div class="form-group row">
  <label for="weahter_source_url" class="col-sm-2 col-form-label">{{ _('Source url') }}</label>
  <div class="col-sm-10">
    <input type="url" class="form-control" id="weahter_source_url" name="value" placeholder="{{ _('Weather data source url') }}">
  </div>
</div>
{% endblock %}

{% block modal_form_javascript_functions %}
{% endblock %}

{% block modal_form_javascript_pre %}
{% endblock %}

{% block modal_form_javascript_load %}
jQuery.get('{{ url_for('api:setting_detail', setting='weather_source') }}', function(data) {
  {{modal_type}}_form.attr({'method' : 'PUT', 'action' : '{{ url_for('api:setting_update', setting='weather_source') }}'});
  {{modal_type}}_form.find('[name="value"]').val(data.value);
  {{modal_type}}_modal.find('div.loading').removeClass('d-flex').hide();
});
{% endblock %}

{% block modal_form_javascript_pre_submit_formdata %}
form_data['value'] = {{modal_type}}_form.find('#weahter_source_url').val();
{% endblock %}